<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="smoothscale">
<title>Using Package 'smoothscale' • smoothscale</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using Package 'smoothscale'">
<meta property="og:description" content="smoothscale">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">smoothscale</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/smoothscale-models.html">Statistical Models used for Smoothing and Scaling</a>
    <a class="dropdown-item" href="../articles/smoothscale-using.html">Using Package 'smoothscale'</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Using Package 'smoothscale'</h1>
            
      
      
      <div class="d-none name"><code>smoothscale-using.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Package <strong>smoothscale</strong> contains functions for doing
simple small area estimation with data that has sampling errors and/or
measurement errors. This vignette demonstrates the use of the functions,
using some synthetic data.</p>
<p>First we load the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bayesiandemography.github.io/smoothscale/">smoothscale</a></span><span class="op">)</span></span></code></pre></div>
<p>We will be using datasets <code>syn_census</code> and
<code>syn_survey</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">syn_census</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 5</span></span></span>
<span><span class="co">#&gt;    area    age   sex    child_labour all_children</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Area 01 5-9   Female          134          372</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Area 02 5-9   Female           14           35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Area 03 5-9   Female           92          388</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Area 04 5-9   Female           46          345</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Area 05 5-9   Female           25          102</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Area 06 5-9   Female            2            5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Area 07 5-9   Female            4           13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Area 08 5-9   Female           10           34</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Area 09 5-9   Female            2           52</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Area 10 5-9   Female          578         <span style="text-decoration: underline;">2</span>087</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 90 more rows</span></span></span></code></pre></div>
<p>The datasets contains synthetic (i.e. fake) data, but the data has a
similar structure to real census and survey data.
<code>syn_census</code> contains, for each combination of area, age, and
sex, counts of children involved in child labour, and counts of all
children. <code>syn_survey</code> contains estimates of overall
probabilities of being involved in child labour, which are assumed to be
accurate.</p>
</div>
<div class="section level2">
<h2 id="function-smooth_prob">Function <code>smooth_prob()</code><a class="anchor" aria-label="anchor" href="#function-smooth_prob"></a>
</h2>
<p>Function <code><a href="../reference/smooth_prob.html">smooth_prob()</a></code> deals with sampling error, which
is typically an important problem when doing small area estimation.
Function <code><a href="../reference/smooth_prob.html">smooth_prob()</a></code> has two main arguments:</p>
<ul>
<li>
<code>count</code> is the count variable that needs to be smoothed,
in our case, counts of child labour</li>
<li>
<code>size</code> is the number of respondents from which counts
were draw, in our case, counts of all children in the census file.</li>
</ul>
<p>A ‘direct’ estimate of the probability that a child is involved in
child labour can be produced by simply dividing each area’s count of
child labour by the number of children,</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">direct</span> <span class="op">&lt;-</span> <span class="va">syn_census</span><span class="op">$</span><span class="va">child_labour</span> <span class="op">/</span> <span class="va">syn_census</span><span class="op">$</span><span class="va">all_children</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">direct</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.0000  0.1885  0.2500  0.2651  0.3170  0.8000</span></span></code></pre></div>
<p>A smoothed version of these estimates can be produced using function
<code><a href="../reference/smooth_prob.html">smooth_prob()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smoothed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_prob.html">smooth_prob</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">syn_census</span><span class="op">$</span><span class="va">child_labour</span>,</span>
<span>                        size <span class="op">=</span> <span class="va">syn_census</span><span class="op">$</span><span class="va">all_children</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">smoothed</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.1053  0.2137  0.2537  0.2645  0.2978  0.5186</span></span></code></pre></div>
<p>Function <code><a href="../reference/smooth_prob.html">smooth_prob()</a></code> pulls prevalences (ie counts
divided by size) towards the overall average. We know, however, that
child labour is likely to vary by age and sex. It would be better to
smooth each combination of age and sex towards their own average.</p>
<p>A convenient way to smooth within combinations of other variables is
to use functions contained in the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> package (part of the<a href="https://www.tidyverse.org" class="external-link">tidyverse</a>.)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="va">smoothed_agesex</span> <span class="op">&lt;-</span> <span class="va">syn_census</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>direct <span class="op">=</span> <span class="va">child_labour</span> <span class="op">/</span> <span class="va">all_children</span>,</span>
<span>         smoothed <span class="op">=</span> <span class="fu"><a href="../reference/smooth_prob.html">smooth_prob</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">child_labour</span>,</span>
<span>                                size <span class="op">=</span> <span class="va">all_children</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">smoothed_agesex</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 7</span></span></span>
<span><span class="co">#&gt;    area    age   sex    child_labour all_children direct smoothed</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Area 01 5-9   Female          134          372 0.360    0.351 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Area 02 5-9   Female           14           35 0.4      0.325 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Area 03 5-9   Female           92          388 0.237    0.236 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Area 04 5-9   Female           46          345 0.133    0.140 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Area 05 5-9   Female           25          102 0.245    0.241 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Area 06 5-9   Female            2            5 0.4      0.252 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Area 07 5-9   Female            4           13 0.308    0.252 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Area 08 5-9   Female           10           34 0.294    0.264 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Area 09 5-9   Female            2           52 0.038<span style="text-decoration: underline;">5</span>   0.099<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Area 10 5-9   Female          578         <span style="text-decoration: underline;">2</span>087 0.277    0.276 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 90 more rows</span></span></span></code></pre></div>
<p>We calculate and plot prevalences, using some more tidyverse packages
and functions,</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">data_for_plot</span> <span class="op">&lt;-</span> <span class="va">smoothed_agesex</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">direct</span>, <span class="va">smoothed</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"measure"</span>,</span>
<span>                 values_to <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>area <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder</a></span><span class="op">(</span><span class="va">area</span>, <span class="va">prob</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_for_plot</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">prob</span>, y <span class="op">=</span> <span class="va">area</span>, color <span class="op">=</span> <span class="va">measure</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkblue"</span>, <span class="st">"darkorange"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="smoothscale-using_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="function-scale_prob">Function <code>scale_prob()</code><a class="anchor" aria-label="anchor" href="#function-scale_prob"></a>
</h2>
<p>Function <code><a href="../reference/scale_prob.html">scale_prob()</a></code> deals with measurement error,
which also arises often in small area estimation. Function
<code><a href="../reference/scale_prob.html">scale_prob()</a></code> has three arguments:</p>
<ul>
<li>
<code>unscaled</code> is the original probability estimate for each
area</li>
<li>
<code>target</code> is an overall probability, assumed to be
error-free</li>
<li>
<code>wt</code> is an optional weighting variable, used to calculate
an overall probability from <code>unscaled</code>.</li>
</ul>
<p>We can use <code><a href="../reference/scale_prob.html">scale_prob()</a></code> to scale the probabilities
estimated earlier using <code><a href="../reference/smooth_prob.html">smooth_prob()</a></code> so that they match
those from <code>syn_survey</code> at the national level.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scaled_agesex</span> <span class="op">&lt;-</span> <span class="va">smoothed_agesex</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">syn_survey</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>scaled <span class="op">=</span> <span class="fu"><a href="../reference/scale_prob.html">scale_prob</a></span><span class="op">(</span>unscaled <span class="op">=</span> <span class="va">smoothed</span>,</span>
<span>                             target <span class="op">=</span> <span class="va">prob_child_labour</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(age, sex)`</span></span>
<span><span class="va">scaled_agesex</span> </span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 9</span></span></span>
<span><span class="co">#&gt;    area  age   sex   child_labour all_children direct smoothed prob_child_labour</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Area… 5-9   Fema…          134          372 0.360    0.351              0.297</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Area… 5-9   Fema…           14           35 0.4      0.325              0.297</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Area… 5-9   Fema…           92          388 0.237    0.236              0.297</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Area… 5-9   Fema…           46          345 0.133    0.140              0.297</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Area… 5-9   Fema…           25          102 0.245    0.241              0.297</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Area… 5-9   Fema…            2            5 0.4      0.252              0.297</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Area… 5-9   Fema…            4           13 0.308    0.252              0.297</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Area… 5-9   Fema…           10           34 0.294    0.264              0.297</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Area… 5-9   Fema…            2           52 0.038<span style="text-decoration: underline;">5</span>   0.099<span style="text-decoration: underline;">5</span>             0.297</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Area… 5-9   Fema…          578         <span style="text-decoration: underline;">2</span>087 0.277    0.276              0.297</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 90 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: scaled &lt;dbl&gt;</span></span></span></code></pre></div>
<p>We graph the results.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_for_plot_scaled</span> <span class="op">&lt;-</span> <span class="va">scaled_agesex</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">direct</span>, <span class="va">smoothed</span>, <span class="va">scaled</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"measure"</span>,</span>
<span>                 values_to <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">measure</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"direct"</span>, <span class="st">"smoothed"</span>, <span class="st">"scaled"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         area <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder</a></span><span class="op">(</span><span class="va">area</span>, <span class="va">prob</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_for_plot_scaled</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">prob</span>, y <span class="op">=</span> <span class="va">area</span>, color <span class="op">=</span> <span class="va">measure</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkblue"</span>, <span class="st">"darkorange"</span>, <span class="st">"darkgreen"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="smoothscale-using_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by John Bryant.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
