<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="smoothscale">
<title>Introduction to Package 'smoothscale' • smoothscale</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Package 'smoothscale'">
<meta property="og:description" content="smoothscale">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">smoothscale</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/smoothscale-intro.html">Introduction to Package 'smoothscale'</a>
    <a class="dropdown-item" href="../articles/smoothscale-models.html">Statistical Models used for Smoothing and Scaling</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to Package 'smoothscale'</h1>
            
      
      
      <div class="d-none name"><code>smoothscale-intro.Rmd</code></div>
    </div>

    
    
<p>Package <strong>smoothscale</strong> contains two functions for doing
simple small area estimation with data that has sampling errors and/or
measurement errors. This vignette demonstrates the use of the two
functions, using some synthetic data.</p>
<p>First we load the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bayesiandemography.github.io/smoothscale/">smoothscale</a></span><span class="op">)</span></span></code></pre></div>
<p>We will be using the dataset <code>syn_census</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">syn_census</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 200 × 5</span></span></span>
<span><span class="co">#&gt;    area    age   sex    child_labour all_children</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Area 01 5-9   Female           42          368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Area 02 5-9   Female           10           33</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Area 03 5-9   Female          112          453</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Area 04 5-9   Female          151          354</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Area 05 5-9   Female           23          101</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Area 06 5-9   Female            3            5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Area 07 5-9   Female            3           14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Area 08 5-9   Female            6           35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Area 09 5-9   Female           14           48</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Area 10 5-9   Female          422         <span style="text-decoration: underline;">1</span>889</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 190 more rows</span></span></span></code></pre></div>
<p>The dataset contains synthetic (i.e. fake) data, but the data has a
similar structure to real census data. For each combination of area,
age, and sex, the dataset has counts of children involved in child
labour, and counts of all children.</p>
<p>The function <code><a href="../reference/smooth_prob.html">smooth_prob()</a></code> has two main arguments:</p>
<ul>
<li>
<code>count</code> is the count variable that needs to be smoothed,
in our case, counts of child labour</li>
<li>
<code>size</code> is the number of respondents from which counts
were draw, in our case, counts of all children in the census file.</li>
</ul>
<p>The function produces a smoothed version of the <code>count</code>
variable.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smoothed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_prob.html">smooth_prob</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">syn_census</span><span class="op">$</span><span class="va">child_labour</span>,</span>
<span>                        size <span class="op">=</span> <span class="va">syn_census</span><span class="op">$</span><span class="va">all_children</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">smoothed</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1205323 0.3007721 0.2486283 0.4217355 0.2356759 0.3776814</span></span></code></pre></div>
<p>Function <code><a href="../reference/smooth_prob.html">smooth_prob()</a></code> pulls prevalences (ie counts
divided by size) towards the overall average. We know, however, that
child labour is likely to vary by age and sex. It would be better to
smooth each combination of age and sex towards their own average.</p>
<p>A convenient way to smooth within combinations of other variables is
to use functions contained in the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> package (part of the<a href="https://www.tidyverse.org" class="external-link">tidyverse</a>.)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="va">smoothed_agesex</span> <span class="op">&lt;-</span> <span class="va">syn_census</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>prev_direct <span class="op">=</span> <span class="va">child_labour</span> <span class="op">/</span> <span class="va">all_children</span>,</span>
<span>         prev_smoothed <span class="op">=</span> <span class="fu"><a href="../reference/smooth_prob.html">smooth_prob</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">child_labour</span>,</span>
<span>                                     size <span class="op">=</span> <span class="va">all_children</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">smoothed_agesex</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 200 × 7</span></span></span>
<span><span class="co">#&gt;    area    age   sex    child_labour all_children prev_direct prev_smoothed</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Area 01 5-9   Female           42          368       0.114         0.121</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Area 02 5-9   Female           10           33       0.303         0.278</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Area 03 5-9   Female          112          453       0.247         0.247</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Area 04 5-9   Female          151          354       0.427         0.416</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Area 05 5-9   Female           23          101       0.228         0.230</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Area 06 5-9   Female            3            5       0.6           0.308</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Area 07 5-9   Female            3           14       0.214         0.231</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Area 08 5-9   Female            6           35       0.171         0.199</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Area 09 5-9   Female           14           48       0.292         0.276</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Area 10 5-9   Female          422         <span style="text-decoration: underline;">1</span>889       0.223         0.224</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 190 more rows</span></span></span></code></pre></div>
<p>We calculate and plot prevalences, using some more tidyverse packages
and functions,</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">data_for_plot</span> <span class="op">&lt;-</span> <span class="va">smoothed_agesex</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">prev_direct</span>, <span class="va">prev_smoothed</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"measure"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>area <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder</a></span><span class="op">(</span><span class="va">area</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_for_plot</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, y <span class="op">=</span> <span class="va">area</span>, color <span class="op">=</span> <span class="va">measure</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="smoothscale-intro_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by John Bryant.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
